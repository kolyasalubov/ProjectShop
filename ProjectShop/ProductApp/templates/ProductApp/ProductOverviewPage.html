{% extends 'UserApp/_base.html' %}
{% block title %} Product Overview {% endblock title %}
{% load static %}
{% load shuffle %}

{% block head %}
    <link rel="stylesheet" href="{% static '/css/ProductOverviewPage.css' %}">
{% endblock %}

{% block content %}
    <div class="wrapper" id='Anchor' >
        <section class="top">
            <div class="photo">
                {% if product_media %}
                    {% for x in product_media|slice:":1" %}
                        {% if x.image %}
                            <img id="myImg" height="100%" width="100%" src="{{ x.image.url }}" >

                            <div id="myModal" class="modal">

                              <!-- The Close Button -->
                              <span class="close">&times;</span>

                              <!-- Modal Content (The Image) -->
                              <img class="modal-content" id="img01">

                              <!-- Modal Caption (Image Text) -->
                              <div id="caption"></div>
                            </div>

                        {% endif %}
                    {% endfor %}
                {% else %}
                    <img height="100%" width="100%" src=" \media\default_image\default_image.png " >
                {% endif %}
            </div>

            <script>
                // Get the modal
                var modal = document.getElementById("myModal");

                // Get the image and insert it inside the modal - use its "alt" text as a caption
                var img = document.getElementById("myImg");
                var modalImg = document.getElementById("img01");
                var captionText = document.getElementById("caption");
                img.onclick = function(){
                  modal.style.display = "block";
                  modalImg.src = this.src;
                  captionText.innerHTML = this.alt;
                }

                // Get the <span> element that closes the modal
                var span = document.getElementsByClassName("close")[0];

                // When the user clicks on <span> (x), close the modal
                span.onclick = function() {
                  modal.style.display = "none";
                }
            </script>

            {% if product_media|slice:"1:" %}
            <div class="additional_photos">
                {% for x in product_media|slice:"1:" %}
                    <div class="additional_photos1">
                        <img height="100%" width="100%" src="{{ x.image.url }}">
                    </div>
                {% endfor %}
            </div>
            {% else %}
            {% endif %}

            <div class="product_info">
                <div class="product_title"><h2>{{ product_object.name }}</h2></div>
                <div class="product_price"><h3>${{ product_object.price }}</h3></div>
                <div class="product_rating_by_stars">stars</div>
                <div class="add_to_cart_button">
                    <input type="button" value="Add to cart" class="add_to_cart_button"/>
                </div>
            </div>
            <div class="tags">
                <h1>Tags</h1>
                {% for tag in product_object.tags.all %}
                    <hr>
                    <h3 style="padding:5px;" >#{{tag}}</h3>
                {% endfor %}



            </div>

        </section>

            <div class="tab">
              <button class="tablinks" onclick="openCity(event, 'Description')" id="defaultOpen">Description</button>
              <button class="tablinks" onclick="openCity(event, 'Reviews')">Reviews</button>
            </div>

            <!-- Tab content -->
            <div id="Description" class="tabcontent">
             <section class="body1">
                 <div class="description_text">
                     {{ product_object.description }}
                 </div>

                    {% for x in product_media_video|slice:":1" %}
                        {% if x.video_link %}
                        <div class="product_video">
                            <iframe width="100%" height="100%" src="{{ x.video_link|slice:':24'|add:'embed/'}}{{ x.video_link|slice:'32:' }}">
                            </iframe>
                       </div>
                       {%else%}
                       {% endif %}
                    {% endfor %}

                 </div>
             </section>
            </div>

            <div id="Reviews" class="tabcontent">

             <section class="body2">
                 {% for comment_data in comments %}
                     <div class="reviews">
                      <div class="name">{{ comment_data.user }}</div>
                      <div class="points">{{ comment_data.rating }}</div>
                      <div class="reply">
                          <div class="like"><input type="button" value="Like" class="add_to_cart_button"/></div>
                          <div class="like_count">2</div>
                          <div class="dislike"><input type="button" value="Dislike" class="add_to_cart_button"/></div>
                          <div class="dislike_count">1</div>
                      </div>
                      <div class="comment">{{ comment_data.comment }}</div>
                      </div>
                 {% endfor %}
             </section>

             {% if request.user.is_authenticated %}
                <form method="post" style="margin-top: 1.3em;">
                    {{ comment_form.as_p }}
                    {% csrf_token %}
                    <button type="submit" class="btn btn-primary  btn-lg">Submit</button>
                  </form>
            {% else %}
                <p> Please log in to leave a comment</p>
            {% endif %}

            </div>

            <script>
                function openCity(evt, cityName) {
                  var i, tabcontent, tablinks;
                  tabcontent = document.getElementsByClassName("tabcontent");
                  for (i = 0; i < tabcontent.length; i++) {
                    tabcontent[i].style.display = "none";
                  }
                  tablinks = document.getElementsByClassName("tablinks");
                  for (i = 0; i < tablinks.length; i++) {
                    tablinks[i].className = tablinks[i].className.replace(" active", "");
                  }
                  document.getElementById(cityName).style.display = "block";
                  evt.currentTarget.className += " active";
                }
                document.getElementById("defaultOpen").click();
            </script>

            <h2 style="padding:10px;">You might also lookig for :</h2>

        <section class="might_interested">

            {% for x in product_all|shuffle|slice:':4' %}
                <div class="might_interested_item">
                    <a href="{% url 'product_overview' x.product_id  %}" > <img width="100%" height="100%" src="{{ x.image.url }}" > </a>
                </div>

            {% endfor %}

        </section>

<!--        <section class="additional_buttons">-->
<!--            <a href="#Anchor">-->
<!--                <div class="up_anchor"><input type="button" value="UP" class="add_to_cart_button"/></div>-->
<!--            </a>-->
<!--            <a href="{% url 'home' %}">-->
<!--                <div class="view_more_button"><input type="button" value="View more" class="add_to_cart_button"/></div>-->
<!--            </a>-->
<!--        </section>-->

    </div>
{% endblock content%}

